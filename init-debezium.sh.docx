#!/bin/sh

echo "⏳ Attente du démarrage de Debezium..."
sleep 15

echo "📡 Vérification du connecteur existant..."
EXISTS=$(curl -s http://connect:8083/connectors | grep ticket-postgres-connector)

if [ -z "$EXISTS" ]; then
  echo "🚀 Création du connecteur Debezium PostgreSQL..."
  curl -X POST -H "Content-Type: application/json" --data @/kafka/init/postgres-connector.json http://connect:8083/connectors
else
  echo "✅ Le connecteur existe déjà. Pas de création nécessaire."
fi
